

<!-- Kopen -->
<div class="tab-content" id="buy">
    <div class="border rounded-2xl p-6 shadow-sm space-y-4">
        <h2 class="text-xl font-semibold">FestCoins Kopen</h2>
        <p class="text-gray-500">Voeg Festcoins toe aan je account</p>

        <form id="koopform">
            <div class="grid gap-2">
                <label for="buyAmount" class="font-medium">Bedrag (€)</label>
                <input id="buyAmount" type="number" placeholder="0" min="0"
                class="border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>

            <div class="flex gap-2">
                <button class="border px-4 py-2 rounded-lg hover:bg-gray-100" onclick="setAmount('buyAmount', 10)">€10</button>
                <button class="border px-4 py-2 rounded-lg hover:bg-gray-100" onclick="setAmount('buyAmount', 25)">€25</button>
                <button class="border px-4 py-2 rounded-lg hover:bg-gray-100" onclick="setAmount('buyAmount', 50)">€50</button>
                <button class="border px-4 py-2 rounded-lg hover:bg-gray-100" onclick="setAmount('buyAmount', 100)">€100</button>
            </div>

            <button type="submit" class="w-full bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 flex justify-center items-center">
                <i class="fa-solid fa-arrow-down-left mr-2"></i>
                FestCoins Kopen
            </button>

            <p id="errorMsg" class="font-thin text-red-600 "></p>
        </form>
    </div>
</div>

<script>

// 
document.getElementById("koopform").addEventListener("submit", async (e) => {
    e.preventDefault();
    const buyAmount = document.getElementById("buyAmount").value;
    const errorMsg = document.getElementById("errorMsg")

    let res;
    console.log("button pressed.")
    if (buyAmount){
        if (buyAmount > 0){
            res = await fetch("/addAmount", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({ buyAmount }),
            });
        }
        else {
            return errorMsg.textContent = "Geef een waarde groter dan nul in.";
        }
    }
    else {
        return errorMsg.textContent = "Geef een waarde in.";
    }


    const result = await res.json();

    if(result.success){
        showNotification("Succesvol " + buyAmount + " festcoins toegevoegd.");
        document.getElementById("buyAmount").value="";
    } else{
        errorMsg.textContent = result.error;
    }
});

// notificatie tonen
function showNotification(message) {
    const notif = document.getElementById("koop-notificatie");
    notif.textContent = message;
    notif.classList.remove("opacity-0");

    setTimeout(()=> {
        notif.classList.add("opacity-0");
    }, 1500);
}
</script>