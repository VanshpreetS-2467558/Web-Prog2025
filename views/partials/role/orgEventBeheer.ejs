
<%
  // Dummy placeholder
  let event = {
    id: '1',
    name: 'Festival Example',
    location: 'Stadion',
    description: 'Een leuk evenement!',
    startDate: new Date().toISOString(),
    endDate: new Date(Date.now() + 3600 * 1000).toISOString(),
    isLive: false, <!-- false of true -->
    sections: [
      { id: 's1', name: 'Bar 1', items: [{ id:'i1', name:'Pils', price:3.5, stock:10 }] },
      { id: 's2', name: 'Tent 2', items: [] }
    ]
  };
%>

<!-- let event = null; // of undefined  (hier moeten nog js <%%> tuusen)-->
<!-- DUMMY PLACEHOLDER TEST , GAAT WEG WANT MOET VIA BACKEND-->
<!-------------------------------------------------------------------------------------------------------------------------------------------------->


<div class="container mx-auto px-4 py-8">
  <% if (!event) { %>
    <div class="flex flex-col items-center justify-center min-h-[60vh] gap-6">
      <h2 class="text-3xl font-bold">Maak je evenement aan</h2>

      <!-- Event Form Modal Trigger -->
      <button class="bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center gap-2" onclick="document.getElementById('newEventModal').classList.remove('hidden')">
        <i class="fa-solid fa-plus"></i>
        Maak Event Aan
      </button>

      <!-- Event Form Modal -->
      <div id="newEventModal" class="fixed inset-0 bg-black/50 flex hidden justify-center items-start pt-20 z-50">
        <div class="bg-white rounded-xl p-6 w-full max-w-2xl">
          <h3 class="text-xl font-semibold mb-2">Nieuw Evenement Aanmaken</h3>
          <p class="text-gray-500 mb-4">Vul de gegevens van je evenement in</p>

          <form action="/events/create" method="POST" class="grid gap-4">
            <div class="grid gap-2">
              <label for="name">Naam *</label>
              <input id="name" name="name" class="border rounded-lg px-3 py-2" required>
            </div>

            <div class="grid gap-2">
              <label for="location">Locatie *</label>
              <input id="location" name="location" class="border rounded-lg px-3 py-2" required>
            </div>

            <div class="grid gap-2">
              <label for="description">Beschrijving</label>
              <textarea id="description" name="description" class="border rounded-lg px-3 py-2"></textarea>
            </div>

            <div class="grid grid-cols-2 gap-4">
              <div class="grid gap-2">
                <label for="startDate">Start Datum & Tijd *</label>
                <input id="startDate" type="datetime-local" name="startDate" class="border rounded-lg px-3 py-2" required>
              </div>
              <div class="grid gap-2">
                <label for="endDate">Eind Datum & Tijd *</label>
                <input id="endDate" type="datetime-local" name="endDate" class="border rounded-lg px-3 py-2" required>
              </div>
            </div>

            <div class="flex justify-end gap-2 mt-4">
              <button type="button" class="px-4 py-2 border rounded-lg" onclick="document.getElementById('newEventModal').classList.add('hidden')">Annuleren</button>
              <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg">Evenement Aanmaken</button>
            </div>
          </form>
        </div>
      </div>
    </div>
  <% } else { %>
    <div class="space-y-6">
      <!-- Event Card -->
      <div class="border rounded-2xl p-6 shadow-sm flex justify-between items-start">
        <div>
          <h2 class="text-3xl font-semibold"><%= event.name %></h2>
          <div class="mt-3 space-y-2 text-gray-500 text-sm">
            <div class="flex items-center gap-2">
              <i class="fa-solid fa-map-pin"></i>
              <%= event.location %>
            </div>
            <div class="flex items-center gap-2">
              <i class="fa-solid fa-calendar"></i>
              <%= new Date(event.startDate).toLocaleString("nl-NL") %> - <%= new Date(event.endDate).toLocaleString("nl-NL") %>
            </div>
            <% if (event.description) { %>
              <p class="mt-2"><%= event.description %></p>
            <% } %>
          </div>
        </div>
        <p class="<%= event.isLive ? 'bg-green-600' : 'bg-red-500' %> px-4 py-2 rounded-lg text-white">Live</p>
        
      </div>

      <!-- Sections & Items -->
      <div class="border rounded-2xl p-6 shadow-sm">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-semibold">Locaties & Items</h3>
          <button class="bg-gray-200 px-3 py-1 rounded-lg flex items-center gap-2" onclick="document.getElementById('newSectionModal').classList.remove('hidden')">
            <i class="fa-solid fa-plus"></i> Locatie Toevoegen
          </button>
        </div>

        <!-- New Section Modal -->
        <div id="newSectionModal" class="hidden fixed inset-0 bg-black/50 flex justify-center items-start pt-20 z-50">
          <div class="bg-white rounded-xl p-6 w-full max-w-md">
            <h3 class="text-xl font-semibold mb-2">Nieuwe Locatie</h3>
            <p class="text-gray-500 mb-4">Voeg een nieuwe locatie toe (bijv. Bar 1, Tent 2)</p>
            <form action="/sections/add" method="POST" class="grid gap-4">
              <input type="hidden" name="eventId" value="<%= event.id %>">
              <div class="grid gap-2">
                <label for="sectionName">Sectie Naam</label>
                <input id="sectionName" name="name" class="border rounded-lg px-3 py-2" placeholder="bijv. Bar 1, Tent 2" required>
              </div>
              <div class="flex justify-end gap-2 mt-4">
                <button type="button" class="px-4 py-2 border rounded-lg" onclick="document.getElementById('newSectionModal').classList.add('hidden')">Annuleren</button>
                <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg">locatie Toevoegen</button>
              </div>
            </form>
          </div>
        </div>

        <% if (event.sections.length === 0) { %>
          <p class="text-gray-500 text-center py-8">Nog geen locatie toegevoegd</p>
        <% } else { %>
          <div class="grid gap-4">
            <% event.sections.forEach(section => { %>
              <div class="border rounded-xl p-4">
                <div class="flex justify-between items-center mb-2">
                  <h4 class="text-lg font-semibold"><%= section.name %></h4>
                  <button class="bg-gray-200 px-2 py-1 rounded-lg flex items-center gap-1" onclick="document.getElementById('newItemModal-<%= section.id %>').classList.remove('hidden')">
                    <i class="fa-solid fa-plus"></i> Item Toevoegen
                  </button>
                </div>

                <!-- New Item Modal -->
                <div id="newItemModal-<%= section.id %>" class="hidden fixed inset-0 bg-black/50 flex justify-center items-start pt-20 z-50">
                  <div class="bg-white rounded-xl p-6 w-full max-w-md">
                    <h3 class="text-xl font-semibold mb-2">Nieuw Item voor <%= section.name %></h3>
                    <form action="/items/add" method="POST" class="grid gap-4">
                      <input type="hidden" name="sectionId" value="<%= section.id %>">
                      <div class="grid gap-2">
                        <label for="itemName">Item Naam</label>
                        <input id="itemName" name="name" class="border rounded-lg px-3 py-2" placeholder="bijv. Pils, Cola" required>
                      </div>
                      <div class="grid gap-2">
                        <label for="itemPrice">Prijs (in FestCoins)</label>
                        <input id="itemPrice" type="number" step="0.01" name="price" class="border rounded-lg px-3 py-2" required>
                      </div>
                      <div class="grid gap-2">
                        <label for="itemStock">Voorraad</label>
                        <input id="itemStock" type="number" name="stock" class="border rounded-lg px-3 py-2" required>
                      </div>
                      <div class="flex justify-end gap-2 mt-4">
                        <button type="button" class="px-4 py-2 border rounded-lg" onclick="document.getElementById('newItemModal-<%= section.id %>').classList.add('hidden')">Annuleren</button>
                        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-lg">Item Toevoegen</button>
                      </div>
                    </form>
                  </div>
                </div>

                <% if (section.items.length === 0) { %>
                  <p class="text-gray-500 text-sm">Nog geen items</p>
                <% } else { %>
                  <div class="grid gap-2">
                    <% section.items.forEach(item => { %>
                      <div class="flex justify-between items-center p-3 bg-gray-100 rounded-lg">
                        <div>
                          <p class="font-medium"><%= item.name %></p>
                          <p class="text-sm text-gray-500">Voorraad: <%= item.stock %></p>
                        </div>
                        <p class="font-semibold text-lg"><%= item.price.toFixed(2) %> FestCoins</p>
                      </div>
                    <% }) %>
                  </div>
                <% } %>
              </div>
            <% }) %>
          </div>
        <% } %>
      </div>
    </div>
  <% } %>
</div>
